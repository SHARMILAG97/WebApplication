package com.revature.WatrerPlant.Service;

import java.time.LocalDate;
import java.util.Scanner;

import com.revature.WaterPlant.dao.OrderDao;
import com.revature.WaterPlant.dao.OrderInterface;
import com.revature.WaterPlant.dao.StockDao;
import com.revature.WaterPlant.dao.StockInterface;
import com.revature.WaterPlant.exception.DBException;
import com.revature.WaterPlant.model.User;

public class OrderCans {

	public static void cansOrder(User u)     {
		
		User user = u;
		int Availcans=0;
		StockInterface Sdao = new StockDao();
		User stock = Sdao.getStock();
		Availcans = Sdao.findOne();
		System.out.println("No of Avilable Cans :"+Availcans);
		System.out.println("Enter No of cans to Order");
		Scanner sc = new Scanner(System.in);
		int Ordercans= sc.nextInt();
		
		
		while(Availcans<Ordercans && Ordercans<50) {
			System.out.println("Insufficient Watercans");
			System.out.println("Please enter cans below :"+Availcans+"or below 50");
		}
		
		int Updatecans= Availcans-Ordercans;
		
		try {
			LocalDate d = stock.getDate();
			int ordercan = stock.getOrdercan();
			OrderInterface dao = new OrderDao();
			if(d!=null) {
				ordercan+=Ordercans;
				Availcans-=Ordercans;
				 Sdao.updateStockOrder(Availcans,ordercan);
			}
			dao.addOder(user,Ordercans);
			System.out.println("Ordered Successfully");
			Sdao.addStockOrder(Ordercans,Updatecans);
			System.out.println("Updated in stock Successfully");
			
		} catch (DBException e) {
			e.printStackTrace();
		}
		
		
		
		
	}

	

	

}
